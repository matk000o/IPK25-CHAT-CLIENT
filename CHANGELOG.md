I don't think that the user input handling correctly implemented Processing of additional user input is deferred until after the previous action has been completed.

sending/receiving message content with 60k+ characters isn't tested properly  

maybe move tcp client initialisation right to the auth message?